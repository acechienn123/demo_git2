<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quản lý sản phẩm</title>
  <link href="https://cdn.lineicons.com/4.0/lineicons.css" rel="stylesheet" />
  <link rel="stylesheet" href="bootstrap-5.3.3-dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="style.css">
  <link href="https://cdn.datatables.net/1.11.3/css/dataTables.bootstrap5.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>

<body>
  <div class="wrapper">
    <aside id="sidebar">
      <div class="d-flex">
        <button class="toggle-btn" type="button">
          <i class="lni lni-grid-alt"></i>
        </button>
        <div class="sidebar-logo">
          <a href="thongke.html">Admin </a>
        </div>
      </div>
      <ul class="sidebar-nav">
        <li class="sidebar-item">
          <a href="thongke.html" class="sidebar-link">
            <i class="lni lni-cog"></i>
            <span>Thống kê</span>
          </a>
        </li>

        <!-- <li class="sidebar-item">
          <a href="#" class="sidebar-link">
            <i class="lni lni-agenda"></i>
            <span>Hàng tồn kho</span>
          </a>
        </li> -->
        <li class="sidebar-item">
          <a href="#" class="sidebar-link collapsed has-dropdown" data-bs-toggle="collapse" data-bs-target="#auth"
            aria-expanded="false" aria-controls="auth">
            <i class="lni lni-protection"></i>
            <span>Quản lý</span>
          </a>
          <ul id="auth" class="sidebar-dropdown list-unstyled collapse" data-bs-parent="#sidebar">
            <li class="sidebar-item">
              <a href="quanlynguoidung.html" class="sidebar-link">Người dùng</a>
            </li>
            <li class="sidebar-item">
              <a href="quanlydichvu.html" class="sidebar-link">Dịch vụ</a>
            </li>
            <li class="sidebar-item">
              <a href="quanlysanpham.html" class="sidebar-link">Sản phẩm</a>
            </li>
            <li class="sidebar-item">
              <a href="quanlydonhang.html" class="sidebar-link">Đơn hàng</a>
            </li>
            <li class="sidebar-item">
              <a href="quanlylichhen.html" class="sidebar-link">Lịch hẹn</a>
            </li>
            <li class="sidebar-item">
              <a href="quanlythucung.html" class="sidebar-link">Thú cưng</a>
            </li>
          </ul>
        </li>
        <!-- <li class="sidebar-item">
                    <a href="#" class="sidebar-link collapsed has-dropdown" data-bs-toggle="collapse"
                        data-bs-target="#multi" aria-expanded="false" aria-controls="multi">
                        <i class="lni lni-layout"></i>
                        <span>Multi Level</span>
                    </a>
                    <ul id="multi" class="sidebar-dropdown list-unstyled collapse" data-bs-parent="#sidebar">
                        <li class="sidebar-item">
                            <a href="#" class="sidebar-link collapsed" data-bs-toggle="collapse"
                                data-bs-target="#multi-two" aria-expanded="false" aria-controls="multi-two">
                                Two Links
                            </a>
                            <ul id="multi-two" class="sidebar-dropdown list-unstyled collapse">
                                <li class="sidebar-item">
                                    <a href="#" class="sidebar-link">Link 1</a>
                                </li>
                                <li class="sidebar-item">
                                    <a href="#" class="sidebar-link">Link 2</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li> -->
        <li class="sidebar-item">
          <a href="hotrokhachhang.html" class="sidebar-link">
            <i class="lni lni-popup"></i>
            <span>Hỗ trợ khách hàng</span>
          </a>
        </li>
        <li class="sidebar-item">
          <a href="#" class="sidebar-link" data-bs-toggle="modal" data-bs-target="#userAccountModal">
            <i class="lni lni-user"></i>
            <span>Thông tin tài khoản</span>
          </a>
        </li>
        <li class="sidebar-item">
          <a href="index_test.html" class="sidebar-link">
            <i class="lni lni-exit"></i>
            <span>Đăng xuất</span>
          </a>
        </li>
      </ul>
      <!-- <div class="sidebar-footer">
        <a href="#" class="sidebar-link">
          <i class="lni lni-exit"></i>
          <span>Đăng xuất</span>
        </a>
      </div> -->
    </aside>
    <div class="main">
      <nav class="navbar navbar-expand px-4 py-3">
        <form action="" class="d-none d-sm-inline-block">
          <div class="input-group mb-3">
            <input type="text" class="form-control" id="searchInput" placeholder="Tìm kiếm sản phẩm">
            <button class="btn btn-primary" onclick="searchService()">Tìm kiếm</button>
          </div>
        </form>
        <div class="navbar-collapse collapse">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item dropdown">
              <div>
                <a type="button" class=" position-relative" style="margin-right: 20px;">
                  <i class="fa-solid fa-message fs-5"></i>
                  <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                    10+
                  </span>
                </a>
                <a type="button" class=" position-relative" style="margin-right: 20px;">
                  <i class="fa-solid fa-bell fs-5"></i>
                  <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                    10+
                  </span>
                </a>
                <a href="#" data-bs-toggle="dropdown" class="nav-icon pe-md-0">
                  <img src="account.png" class="avatar img-fluid" alt="">
                </a>
                <div class="dropdown-menu dropdown-menu-end rounded">
                  <a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#activityLogModal">Lịch sử
                    hoạt động</a>
                  <a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#changePasswordModal">Đổi mật
                    khẩu</a>
                </div>
              </div>


            </li>
          </ul>
        </div>
        <!-- Activity Log Modal -->
        <div class="modal fade" id="activityLogModal" tabindex="-1" aria-labelledby="activityLogModalLabel"
          aria-hidden="true">
          <div class="modal-dialog modal-lg">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="activityLogModalLabel">Lịch sử hoạt động</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <!-- Dữ liệu mẫu cho lịch sử hoạt động -->
                <table class="table table-bordered">
                  <thead>
                    <tr>
                      <th>Thời gian</th>
                      <th>Hoạt động</th>
                      <th>Chi tiết</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>2024-06-01 10:00</td>
                      <td>Đăng nhập</td>
                      <td>Admin đã đăng nhập vào hệ thống</td>
                    </tr>
                    <tr>
                      <td>2024-06-01 10:15</td>
                      <td>Thêm người dùng mới</td>
                      <td>Admin đã thêm người dùng Bùi Tiến Đạt</td>
                    </tr>
                    <tr>
                      <td>2024-06-01 11:00</td>
                      <td>Thay đổi mật khẩu</td>
                      <td>Admin đã thay đổi mật khẩu của mình</td>
                    </tr>
                    <tr>
                      <td>2024-06-01 11:30</td>
                      <td>Xóa người dùng</td>
                      <td>Admin đã xóa người dùng Nguyễn Ngọc Vũ</td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Change Password Modal -->
        <div class="modal fade" id="changePasswordModal" tabindex="-1" aria-labelledby="changePasswordModalLabel"
          aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="changePasswordModalLabel">Đổi mật khẩu</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <!-- Form đổi mật khẩu -->
                <form id="changePasswordForm">
                  <div class="mb-3">
                    <label for="currentPassword" class="form-label">Mật khẩu hiện tại</label>
                    <input type="password" class="form-control" id="currentPassword" required>
                  </div>
                  <div class="mb-3">
                    <label for="newPassword" class="form-label">Mật khẩu mới</label>
                    <input type="password" class="form-control" id="newPassword" required>
                  </div>
                  <div class="mb-3">
                    <label for="confirmNewPassword" class="form-label">Xác nhận mật khẩu mới</label>
                    <input type="password" class="form-control" id="confirmNewPassword" required>
                  </div>
                  <button type="submit" class="btn btn-primary">Đổi mật khẩu</button>
                </form>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div class="modal fade" id="userAccountModal" tabindex="-1" aria-labelledby="userAccountModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="userAccountModalLabel">Thông tin tài khoản</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form id="userAccountForm">
                <div class="mb-3">
                  <label for="userName" class="form-label">Tên người dùng</label>
                  <input type="text" class="form-control" id="userName" value="Nguyễn Thế An" readonly>
                </div>
                <div class="mb-3">
                  <label for="userEmail" class="form-label">Email</label>
                  <input type="email" class="form-control" id="userEmail" value="annguyenthe2003@gmail.com" readonly>
                </div>
                <div class="mb-3">
                  <label for="userPhone" class="form-label">Số điện thoại</label>
                  <input type="text" class="form-control" id="userPhone" value="0123456789" readonly>
                </div>
                <div class="mb-3">
                  <label for="userAddress" class="form-label">Địa chỉ</label>
                  <input type="text" class="form-control" id="userAddress" value="123 Đường ABC, Phường XYZ, Hà Nội"
                    readonly>
                </div>
                <div id="editButtons" class="d-none">
                  <button type="button" class="btn btn-primary" onclick="saveUserInfo()">Lưu</button>
                  <button type="button" class="btn btn-secondary" onclick="toggleEdit(false)">Hủy</button>
                </div>
                <div id="viewButton">
                  <button type="button" class="btn btn-warning" onclick="toggleEdit(true)">Chỉnh sửa</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
      <main>
        <div class="container my-5">
          <h1 class="mb-4">Quản lý sản phẩm</h1>
          <button type="button" class="btn btn-primary mb-3" data-bs-toggle="modal"
            data-bs-target="#addProductModal">Thêm Sản Phẩm</button>
          <table id="productTable" class="table table-bordered table-striped">
            <thead class="table-dark">
              <tr>
                <th scope="col">STT</th>
                <th scope="col">Hình Ảnh</th>
                <th scope="col">Tên Sản Phẩm</th>
                <th scope="col">Loại</th>
                <th scope="col">Giá</th>
                <th scope="col">Số Lượng</th>
                <th scope="col">Mô Tả</th>
                <th scope="col">Hành Động</th>
              </tr>
            </thead>
            <tbody id="productTableBody">
              <!-- Dữ liệu sản phẩm sẽ được chèn động tại đây -->
            </tbody>
          </table>
          <nav aria-label="Page navigation example">
            <ul class="pagination">
              <li class="page-item"><a class="page-link" href="#" id="prevPage">1</a></li>
              <li class="page-item"><a class="page-link" href="#" id="nextPage">2</a></li>
            </ul>
          </nav>
        </div>

        <!-- Modal Thêm Sản Phẩm -->
        <div class="modal fade" id="addProductModal" tabindex="-1" aria-labelledby="addProductModalLabel"
          aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="addProductModalLabel">Thêm Sản Phẩm</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <form id="addProductForm">
                  <div class="mb-3">
                    <label for="productName" class="form-label">Tên Sản Phẩm</label>
                    <input type="text" class="form-control" id="productName" required>
                  </div>
                  <div class="mb-3">
                    <label for="productType" class="form-label">Loại</label>
                    <input type="text" class="form-control" id="productType" required>
                  </div>
                  <div class="mb-3">
                    <label for="productPrice" class="form-label">Giá</label>
                    <input type="number" class="form-control" id="productPrice" required>
                  </div>
                  <div class="mb-3">
                    <label for="productQuantity" class="form-label">Số Lượng</label>
                    <input type="number" class="form-control" id="productQuantity" required>
                  </div>
                  <div class="mb-3">
                    <label for="productImage" class="form-label">Hình Ảnh</label>
                    <input type="file" class="form-control" id="productImage" accept="image/*" required>
                  </div>
                  <div class="mb-3">
                    <label for="productDescription" class="form-label">Mô Tả</label>
                    <textarea class="form-control" id="productDescription" rows="3" required></textarea>
                  </div>
                  <button type="submit" class="btn btn-primary">Thêm</button>
                </form>
              </div>
            </div>
          </div>
        </div>

        <!-- Modal Sửa Sản Phẩm -->
        <div class="modal fade" id="editProductModal" tabindex="-1" aria-labelledby="editProductModalLabel"
          aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="editProductModalLabel">Sửa Sản Phẩm</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <form id="editProductForm">
                  <div class="mb-3">
                    <label for="editProductName" class="form-label">Tên Sản Phẩm</label>
                    <input type="text" class="form-control" id="editProductName" required>
                  </div>
                  <div class="mb-3">
                    <label for="editProductType" class="form-label">Loại</label>
                    <input type="text" class="form-control" id="editProductType" required>
                  </div>
                  <div class="mb-3">
                    <label for="editProductPrice" class="form-label">Giá</label>
                    <input type="number" class="form-control" id="editProductPrice" required>
                  </div>
                  <div class="mb-3">
                    <label for="editProductQuantity" class="form-label">Số Lượng</label>
                    <input type="number" class="form-control" id="editProductQuantity" required>
                  </div>
                  <div class="mb-3">
                    <label for="editProductImage" class="form-label">Hình Ảnh</label>
                    <input type="file" class="form-control" id="editProductImage" accept="image/*">
                  </div>
                  <div class="mb-3">
                    <label for="editProductDescription" class="form-label">Mô Tả</label>
                    <textarea class="form-control" id="editProductDescription" rows="3" required></textarea>
                  </div>
                  <button type="submit" class="btn btn-primary">Lưu Thay Đổi</button>
                </form>
              </div>
            </div>
          </div>
        </div>

        <!-- Modal Xóa Sản Phẩm -->
        <div class="modal fade" id="deleteProductModal" tabindex="-1" aria-labelledby="deleteProductModalLabel"
          aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="deleteProductModalLabel">Xóa Sản Phẩm</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                Bạn có chắc chắn muốn xóa sản phẩm này không?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button>
                <button type="button" class="btn btn-danger " id="confirmDeleteButton"
                  data-bs-dismiss="modal">Xóa</button>
              </div>
            </div>
          </div>
        </div>
      </main>

      <!-- Bootstrap JS -->
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

      <!-- JavaScript -->
      <script>
        // Dữ liệu mẫu
        const products = [
          { id: 1, image: 'img/item1.jpg', name: 'Thức Ăn Chó', type: 'Thức Ăn', price: 150000, quantity: 20, description: 'Thức ăn chất lượng cao cho chó.' },
          { id: 2, image: 'img/item2.jpg', name: 'Thuốc Vitamin Cho Mèo', type: 'Thuốc', price: 90000, quantity: 7, description: 'Thuốc bổ sung vitamin cho mèo.' },
          { id: 3, image: 'img/item3.jpg', name: 'Đồ Chơi Chó', type: 'Đồ Chơi', price: 50000, quantity: 10, description: 'Đồ chơi giúp chó phát triển trí tuệ.' },
          { id: 4, image: 'img/item4.jpg', name: 'Dầu Tắm Cho Chó Mèo', type: 'Phụ Kiện', price: 35000, quantity: 10, description: 'Dầu tắm dịu nhẹ cho chó mèo.' },
          { id: 5, image: 'img/item5.jpg', name: 'Chuồng thú cưng', type: 'Phụ Kiện', price: 45000, quantity: 8, description: 'Chuồng di động cho thú cưng.' },

          { id: 6, image: 'img/item6.jpg', name: 'Thuốc Diệt Ký Sinh Trùng', type: 'Thuốc', price: 120000, quantity: 5, description: 'Thuốc diệt ký sinh trùng cho thú cưng.' },

          // Thêm các sản phẩm khác ở đây
        ];

        const rowsPerPage = 4; // Số sản phẩm trên mỗi trang
        let currentPage = 1;

        function displayProducts(page) {
          const start = (page - 1) * rowsPerPage;
          const end = page * rowsPerPage;
          const paginatedProducts = products.slice(start, end);

          const tableBody = document.getElementById('productTableBody');
          tableBody.innerHTML = '';

          paginatedProducts.forEach((product, index) => {
            const row = `
                      <tr>
                        <th scope="row">${start + index + 1}</th>
                        <td><img src="${product.image}" class="img-thumbnail" alt="${product.name}"></td>
                        <td>${product.name}</td>
                        <td>${product.type}</td>
                        <td>${product.price.toLocaleString('vi-VN')} VND</td>
                        <td>${product.quantity}</td>
                        <td>${product.description}</td>
                        <td>
                          <button type="button" class="btn btn-warning btn-sm" data-bs-toggle="modal" data-bs-target="#editProductModal" onclick="editProduct(${product.id})">Sửa</button>
                          <button type="button" class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#deleteProductModal" onclick="deleteProduct(${product.id})">Xóa</button>
                        </td>
                      </tr>
                    `;
            tableBody.insertAdjacentHTML('beforeend', row);
          });
        }

        function updatePagination() {
          const prevPageLink = document.getElementById('prevPage');
          const nextPageLink = document.getElementById('nextPage');

          prevPageLink.parentElement.classList.toggle('disabled', currentPage === 1);
          nextPageLink.parentElement.classList.toggle('disabled', currentPage === Math.ceil(products.length / rowsPerPage));
        }

        document.getElementById('prevPage').addEventListener('click', function (e) {
          e.preventDefault();
          if (currentPage > 1) {
            currentPage--;
            displayProducts(currentPage);
            updatePagination();
          }
        });

        document.getElementById('nextPage').addEventListener('click', function (e) {
          e.preventDefault();
          if (currentPage < Math.ceil(products.length / rowsPerPage)) {
            currentPage++;
            displayProducts(currentPage);
            updatePagination();
          }
        });

        // Khởi tạo hiển thị sản phẩm và phân trang
        displayProducts(currentPage);
        updatePagination();

        // Xử lý thêm sản phẩm
        document.getElementById('addProductForm').addEventListener('submit', function (e) {
          e.preventDefault();
          const productName = document.getElementById('productName').value;
          const productType = document.getElementById('productType').value;
          const productPrice = document.getElementById('productPrice').value;
          const productQuantity = document.getElementById('productQuantity').value;
          const productImage = document.getElementById('productImage').files[0];
          const productDescription = document.getElementById('productDescription').value;

          const reader = new FileReader();
          reader.onload = function (e) {
            const newProduct = {
              id: products.length + 1,
              image: e.target.result,
              name: productName,
              type: productType,
              price: parseFloat(productPrice),
              quantity: parseInt(productQuantity),
              description: productDescription
            };
            products.push(newProduct);
            displayProducts(currentPage);
            updatePagination();
            document.getElementById('addProductForm').reset();
            bootstrap.Modal.getInstance(document.getElementById('addProductModal')).hide();
          };
          reader.readAsDataURL(productImage);
        });

        // Xử lý sửa sản phẩm
        function editProduct(id) {
          const product = products.find(p => p.id === id);
          document.getElementById('editProductName').value = product.name;
          document.getElementById('editProductType').value = product.type;
          document.getElementById('editProductPrice').value = product.price;
          document.getElementById('editProductQuantity').value = product.quantity;
          document.getElementById('editProductDescription').value = product.description;

          document.getElementById('editProductForm').onsubmit = function (e) {
            e.preventDefault();
            product.name = document.getElementById('editProductName').value;
            product.type = document.getElementById('editProductType').value;
            product.price = parseFloat(document.getElementById('editProductPrice').value);
            product.quantity = parseInt(document.getElementById('editProductQuantity').value);
            product.description = document.getElementById('editProductDescription').value;

            const productImageFile = document.getElementById('editProductImage').files[0];
            if (productImageFile) {
              const reader = new FileReader();
              reader.onload = function (e) {
                product.image = e.target.result;
                displayProducts(currentPage);
                bootstrap.Modal.getInstance(document.getElementById('editProductModal')).hide();
              };
              reader.readAsDataURL(productImageFile);
            } else {
              displayProducts(currentPage);
              bootstrap.Modal.getInstance(document.getElementById('editProductModal')).hide();
            }
          };
        }

        // Xử lý xóa sản phẩm
        function deleteProduct(id) {
          const index = products.findIndex(p => p.id === id);
          if (index !== -1) {
            products.splice(index, 1);
            displayProducts(currentPage);
            updatePagination();
          }
          bootstrap.Modal.getInstance(document.getElementById('deleteProductModal')).hide();
        }
      </script>
      </main>



    </div>
  </div>
  <script src="bootstrap-5.3.3-dist/js/bootstrap.bundle.min.js"></script>
  <script src="jquery-3.7.1.min.js"></script>
  <script src="script.js"></script>
</body>

</html>